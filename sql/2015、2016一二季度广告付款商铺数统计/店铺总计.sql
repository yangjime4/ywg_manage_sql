select count(*) from(
select user_id as userid from t_shop s,(select distinct shopid from T_SHOP_MARKET_BRAND where createtime>20150101000000 and createtime<20150401000000 and market_code='10')t where s.shop_id=shopid
union  
select distinct USERID from T_AD_INDUSTRY_USERS  where PAYTIME>20150101000000 and PAYTIME<20150401000000 and market_code='10'
union
select distinct USER_ID as userid from T_AD_KEYWORDS	  where PAYTIME>20150101000000 and PAYTIME<20150401000000 and market_code='10'
union
select user_id as userid from t_shop s,(select distinct SHOPID from T_AD_KEYWORDS_PICTURE     where BEGINDATE>20150100 and BEGINDATE<20150401 and market_code='10')t where s.shop_id=shopid
union
select distinct USER_ID as userid from t_ad_operating     where createtime>20150101000000 and createtime<20150401000000 and market_code='10' and type='2'
union
select distinct USER_ID as userid from t_ad_operating     where createtime>20150101000000 and createtime<20150401000000 and market_code='10' and type='3'
union
select distinct USER_ID as userid from t_ad_operating     where createtime>20150101000000 and createtime<20150401000000 and market_code='10' and type='4'
union
select distinct USER_ID as userid from t_ad_virtualshop          where createtime>20160401000000 and createtime<20160701000000 and market_code='10'
union
select user_id as userid from t_shop s,(select distinct shopid from T_AD_INDUSTRY_OTHER            where STARTTIME>20150101000000 and STARTTIME<20150401000000)t where s.shop_id=shopid
union
select user_id as userid from t_shop s,(select distinct shopid from T_AD_INDUSTRY_CATEGORY             where CREATETIME>20150101000000 and CREATETIME<20150401000000)t where s.shop_id=shopid
union
select distinct USER_ID as userid from T_WEB_EXHIBITION_SHOP              where CREATE_TIME>20150101000000 and CREATE_TIME<20150401000000);

select count(*) from(
select user_id as userid from t_shop s,(select distinct shopid from T_SHOP_MARKET_BRAND where createtime>20150401000000 and createtime<20150701000000 and market_code='10')t where s.shop_id=shopid
union  
select distinct USERID from T_AD_INDUSTRY_USERS  where PAYTIME>20150401000000 and PAYTIME<20150701000000 and market_code='10'
union
select distinct USER_ID as userid from T_AD_KEYWORDS	  where PAYTIME>20150401000000 and PAYTIME<20150701000000 and market_code='10'
union
select user_id as userid from t_shop s,(select distinct SHOPID from T_AD_KEYWORDS_PICTURE     where BEGINDATE>20150100 and BEGINDATE<20150701 and market_code='10')t where s.shop_id=shopid
union
select distinct USER_ID as userid from t_ad_operating     where createtime>20150401000000 and createtime<20150701000000 and market_code='10' and type='2'
union
select distinct USER_ID as userid from t_ad_operating     where createtime>20150401000000 and createtime<20150701000000 and market_code='10' and type='3'
union
select distinct USER_ID as userid from t_ad_operating     where createtime>20150401000000 and createtime<20150701000000 and market_code='10' and type='4'
union
select distinct USER_ID as userid from t_ad_virtualshop          where createtime>20160401000000 and createtime<20160701000000 and market_code='10'
union
select user_id as userid from t_shop s,(select distinct shopid from T_AD_INDUSTRY_OTHER            where STARTTIME>20150401000000 and STARTTIME<20150701000000)t where s.shop_id=shopid
union
select user_id as userid from t_shop s,(select distinct shopid from T_AD_INDUSTRY_CATEGORY             where CREATETIME>20150401000000 and CREATETIME<20150701000000)t where s.shop_id=shopid
union
select distinct USER_ID as userid from T_WEB_EXHIBITION_SHOP              where CREATE_TIME>20150401000000 and CREATE_TIME<20150701000000);

select count(*) from(
select user_id as userid from t_shop s,(select distinct shopid from T_SHOP_MARKET_BRAND where createtime>20160101000000 and createtime<20160401000000 and market_code='10')t where s.shop_id=shopid
union  
select distinct USERID from T_AD_INDUSTRY_USERS  where PAYTIME>20160101000000 and PAYTIME<20160401000000 and market_code='10'
union
select distinct USER_ID as userid from T_AD_KEYWORDS	  where PAYTIME>20160101000000 and PAYTIME<20160401000000 and market_code='10'
union
select user_id as userid from t_shop s,(select distinct SHOPID from T_AD_KEYWORDS_PICTURE     where BEGINDATE>20160100 and BEGINDATE<20160401 and market_code='10')t where s.shop_id=shopid
union
select distinct USER_ID as userid from t_ad_operating     where createtime>20160101000000 and createtime<20160401000000 and market_code='10' and type='2'
union
select distinct USER_ID as userid from t_ad_operating     where createtime>20160101000000 and createtime<20160401000000 and market_code='10' and type='3'
union
select distinct USER_ID as userid from t_ad_operating     where createtime>20160101000000 and createtime<20160401000000 and market_code='10' and type='4'
union
select distinct USER_ID as userid from t_ad_virtualshop          where createtime>20160401000000 and createtime<20160701000000 and market_code='10'
union
select user_id as userid from t_shop s,(select distinct shopid from T_AD_INDUSTRY_OTHER            where STARTTIME>20160101000000 and STARTTIME<20160401000000)t where s.shop_id=shopid
union
select user_id as userid from t_shop s,(select distinct shopid from T_AD_INDUSTRY_CATEGORY             where CREATETIME>20160101000000 and CREATETIME<20160401000000)t where s.shop_id=shopid
union
select distinct USER_ID as userid from T_WEB_EXHIBITION_SHOP              where CREATE_TIME>20160101000000 and CREATE_TIME<20160401000000);

select count(*) from(
select user_id as userid from t_shop s,(select distinct shopid from T_SHOP_MARKET_BRAND where createtime>20160401000000 and createtime<20160701000000 and market_code='10')t where s.shop_id=shopid
union  
select distinct USERID from T_AD_INDUSTRY_USERS  where PAYTIME>20160401000000 and PAYTIME<20160701000000 and market_code='10'
union
select distinct USER_ID as userid from T_AD_KEYWORDS	  where PAYTIME>20160401000000 and PAYTIME<20160701000000 and market_code='10'
union
select user_id as userid from t_shop s,(select distinct SHOPID from T_AD_KEYWORDS_PICTURE     where BEGINDATE>20160100 and BEGINDATE<20160701 and market_code='10')t where s.shop_id=shopid
union
select distinct USER_ID as userid from t_ad_operating     where createtime>20160401000000 and createtime<20160701000000 and market_code='10' and type='2'
union
select distinct USER_ID as userid from t_ad_operating     where createtime>20160401000000 and createtime<20160701000000 and market_code='10' and type='3'
union
select distinct USER_ID as userid from t_ad_operating     where createtime>20160401000000 and createtime<20160701000000 and market_code='10' and type='4'
union
select distinct USER_ID as userid from t_ad_virtualshop          where createtime>20160401000000 and createtime<20160701000000 and market_code='10'
union
select user_id as userid from t_shop s,(select distinct shopid from T_AD_INDUSTRY_OTHER            where STARTTIME>20160401000000 and STARTTIME<20160701000000)t where s.shop_id=shopid
union
select user_id as userid from t_shop s,(select distinct shopid from T_AD_INDUSTRY_CATEGORY             where CREATETIME>20160401000000 and CREATETIME<20160701000000)t where s.shop_id=shopid
union
select distinct USER_ID as userid from T_WEB_EXHIBITION_SHOP              where CREATE_TIME>20160401000000 and CREATE_TIME<20160701000000);



